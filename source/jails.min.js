define(function(){function n(n){var e="component"!=n?"app":n;return function(o,a){return this instanceof t[n]?void c[e].call(this,arguments[2],arguments[1]):t[n+"s"][o]=function(n,t){c[e].call(this,o,n),a.call(this,n,t)}}}var t,e,o,a,r={};a=Array.prototype.slice,t={context:null,config:{},apps:{},controllers:{},components:{},filters:{},app:n("app"),controller:n("controller"),component:n("component"),filter:function(n,t){return this.filters[n]=function(){return function(n,e){return t(e(n))}}},start:function(n,a){e=n.base,t.context=e(document.documentElement),o=e("<i />"),e.extend(!0,t.config,n),i.start(a),t.context.addClass("ready")},refresh:function(n){i.start(n)},data:function(){return r},scanner:function(){return i}};var i={start:function(n){var e=[];n=n||t.context,i.scan("component","[data-component]",n,e),i.scan("controller","[data-controller]",n,e),i.scan("app","[data-app]",n,e),c.start(e)},scan:function(n,o,a,r){a=a||t.context;var c,s,u,l;s=a.get(0).querySelectorAll(o),u=s.length;for(var f=0;u>f;f++)c=e(s[f]),l=i[n],l?l(n,c,r):i.module(n,c,r)},module:function(n,e,o){var a,i,s="s";a=e.data(n),i=t[n+s][a],i=i?new i(e,r):new c[n](a,e,n),o.push(i)},component:function(n,o,a){var r,s,u,l;r=o.data(n),l=i.annotations(r,o),s=r.replace(/\s/g,"").split(/\,/),e.each(s,function(e,r){u=t.components[r],u=u?new u(o,r in l?l[r]:{}):new c[n](r,o),a.push(u)})},annotations:function(n,t){var e,o,a={};return e=t.get(0).previousSibling,e=e?e.previousSibling:null,e&&8==e.nodeType&&(o=e.data.replace(/[\n\t]/g,"").replace(/\@([a-zA-z0-9-]*)\(([^@]*)\)/g,function(n,t,e){a[t]=new Function("return "+e)()})),a}},c={start:function(n){for(var t=n.length,e=0;t>e;e++)n[e].init&&n[e].init();n=null},common:function(n,t){var e=this;this.name=n,this.listen=function(n,o){if(o)t.on(n,function(n,t){o.apply(t.element,[n].concat(t.args))});else for(var a in n)e.listen(a,n[a])},t.on("execute",function(n,t){var o=[].concat(t.args),a=o.shift(),r=e[a];r&&r.apply(e,o),n.stopPropagation()}),t.on("instance",function(o,a){a.call(e,n,t)})},app:function(n,t){c.common.apply(this,arguments);var e=t.get(0);this.watch=function(n,e,o){t.on(e,n,o)},this.x=function(n){return function(){var e=a.call(arguments);t.find(n).trigger("execute",{args:e})}},this.emit=function(o,r){r=a.call(arguments),r.shift(),t.trigger(n+":"+o,{args:r,element:e})},this.publish=function(n,t){t=a.call(arguments),t.shift(),o.trigger(n,{args:t,element:e})},this.subscribe=function(n,t){o.on(n,function(n,e){t.apply(e.element,[n].concat(e.args))})}},component:function(n,t){c.common.apply(this,arguments);this.emit=function(e,o){o=a.call(arguments),o.shift(),t.trigger(n+":"+e,{args:o,element:t.get(0)})}}};return t});
