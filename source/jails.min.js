!function(n,t){"function"==typeof define&&define.amd?define(["jails"],t):"object"==typeof exports?module.exports=t(require("jails")):n.jails=t()}(this,function(){function n(n,t,e,r,i){var o=r["jails-"+e];if(!o){r["jails-"+e]=!0;var u=new n(e,r);t&&t.apply(u,[r,i]),u.init&&u.init()}}function t(t){function r(e){e in d.components&&n(o,d.components[e],e,t,i[e]||{})}var i=e(t),u=t.getAttribute("data-component").split(/\s/);s(u,r)}function e(n){var t,e,r={};return t=n.previousSibling,t=t&&8==t.nodeType?t:t?t.previousSibling:null,t&&8==t.nodeType&&(e=t.data.replace(/[\n\t]/g,"").replace(/\@([a-zA-z0-9-]*)\(([^@]*)\)/g,function(n,t,e){r[t]=new Function("return "+e)()})),r}function r(t){return function(e){var r;r=e.getAttribute("data-"+t),n(u,d[t+"s"][r],r,e,h)}}function i(n,t){function e(t){if(t.detail){var e,i,o,u;e=l(t.detail),i=e.shift(),o=i.split(/\:/),u=o.length>1&&o[0]==n?r[o[1]]:r[o[0]],u&&u.apply(r,e)}t.stopPropagation()}var r=this,i={};this.name=n,this.trigger=d.events.trigger,d.events.on(t,"execute",e),this.off=function(n,e){d.events.off(t,n,i[e])},this.emit=function(e,r){d.events.trigger(t,n+":"+e,r)},this.on=function(n,e,r){r||(r=e,e=null),i[r]=function(n){if(!e)return r.call(t,n);for(var i=n.target;i&&i!=t&&i.parentNode;){if(i.matches?i.matches(e):f(i,e)){r.call(i,n);break}i=i.parentNode}},d.events.on(t,n,i[r])}}function o(n,t){i.apply(this,arguments)}function u(n,t){i.apply(this,arguments),this.publish=b.publish,this.subscribe=b.subscribe,this.listen=function(n,e){d.events.on(t,n,function(n){e.call(n.target,n,n.detail)})},this.x=function(n){return function(){var e=v.call(arguments);s(t.querySelectorAll(n),function(n){d.events.trigger(n,"execute",e)})}}}function c(n,t){return function(e,r){return d[n][e]=r,function(n,i){t.apply(this,[e,n]),r.apply(this,[n,i])}}}function a(){var n={},t={};return{subscribe:function(){var e=v.call(arguments),r=e[0],i=e[1],o=this;r in t&&n[r]?(n[r].push(i),o.publish.apply(null,[r].concat(t[r]))):(n[r]=n[r]||[],n[r].push(i))},publish:function(){var e=v.call(arguments),r=e.shift();n[r]=n[r]||[],n[r].length?s(n[r],function(n){n&&n.apply(this,e)}):t[r]=e}}}function s(n,t){for(var e=0,r=n.length;r>e;e++)t(n[e],e)}function l(n){var t=function(){};return t.prototype=n,new t}function f(n,t){for(var e=n.parentNode.querySelectorAll(t),r=e.length,i=0;r>i;i++)if(e[i]===n)return!0;return!1}function p(){function n(n,t){var e=document.createEvent(n);return t=t||{},e.initEvent(n,t.bubbles||!1,t.cancelable||!1,t.detail||null),e}var t=function(){var n=!1,t=document.lastChild,e=document.createElement("a"),r=function(){n=!0};return e.href="#",e.addEventListener?e.addEventListener("focusin",r):e.onfocusin=r,t.appendChild(e).focus(),t.removeChild(e),n}(),e=function(){try{var n=new CustomEvent("c",{detail:{foo:"b"}});if("c"===n.type&&"b"===n.detail.foo)return CustomEvent}catch(t){return function(n,t){var e=document.createEvent("CustomEvent");return t=t||{},e.initCustomEvent(n,t.bubbles||!1,t.cancelable||!1,t.detail||null),e}}}();return{on:function(){return t?function(n,t,e){var r="focus"==t?"focusin":"blur"==t?"focusout":t;n.addEventListener(r,e,!1)}:function(n,t,e){n.addEventListener(t,e,"focus"==t||"blur"==t)}}(),off:function(n,t,e){n.removeEventListener(t,e,!1)},trigger:function(t,r,i){try{t.dispatchEvent(new n(r,{bubbles:!0,detail:i}))}catch(o){t.dispatchEvent(new e(r,{bubbles:!0,detail:i}))}}}}var d,v,h={},b=a(),m=document.documentElement;v=Array.prototype.slice,d={apps:{},controllers:{},components:{},events:p(),app:c("apps",u),controller:c("controllers",u),component:c("components",o),publish:b.publish,subscribe:b.subscribe,start:function(n){g.scan(n),m.className=m.className.replace("jls-ready","")+" jls-ready"},refresh:function(n){g.scan(n)},data:function(){return h},scanner:function(){return g},render:function(n,t){g.scan(n,function(n){d.events.trigger(n,"execute","destroy")}),n.innerHTML=t}};var g={scan:function(n,t){var e,r,i,o=this.entities;i=n||document;for(var u in o)e=o[u],r=i.querySelectorAll(e.selector),s(r,t||e.method)},entities:{components:{selector:"[data-component]",method:t},controllers:{selector:"[data-controller]",method:r("controller")},app:{selector:"[data-app]",method:r("app")}}};return d});
