!function(t,n){"function"==typeof define&&define.amd?define("jails",n):"object"==typeof exports?module.exports=n(require("jails")):t.jails=n()}(this,function(){function t(t,n,e,r,i){var o=r["jails-"+e];if(!o){r["jails-"+e]=!0;var u=new t(e,r);n&&n.apply(u,[r,i]),u.init&&u.init()}}function n(n){function r(e){e in v.components&&t(o,v.components[e],e,n,i[e]||{})}var i=e(n),u=n.getAttribute("data-component").split(/\s/);s(u,r)}function e(t){var n,e,r={};return n=t.previousSibling,n=n&&8==n.nodeType?n:n?n.previousSibling:null,n&&8==n.nodeType&&(e=n.data.replace(/[\n\t]/g,"").replace(/\@([a-zA-z0-9-]*)\(([^@]*)\)/g,function(t,n,e){r[n]=new Function("return "+e)()})),r}function r(n){return function(e){var r;r=e.getAttribute("data-"+n),t(u,v[n+"s"][r],r,e,h)}}function i(t,n){function e(n){if(n.detail){var e,i,o,u;e=l(n.detail),i=e.shift(),o=i.split(/\:/),u=o.length>1&&o[0]==t?r[o[1]]:r[o[0]],u&&u.apply(r,e)}n.stopPropagation()}var r=this,i={};this.name=t,this.trigger=v.events.trigger,v.events.on(n,"execute",e),this.off=function(t,e){v.events.off(n,t,i[e])},this.emit=function(e,r){v.events.trigger(n,t+":"+e,r)},this.on=function(t,e,r){r||(r=e,e=null),i[r]=function(t){if(!e)return r.call(n,t);for(var i=t.target;i&&i!=n&&i.parentNode;){if(i.matches?i.matches(e):f(i,e)){r.call(i,t);break}i=i.parentNode}},v.events.on(n,t,i[r])}}function o(t,n){i.apply(this,arguments)}function u(t,n){i.apply(this,arguments),this.publish=b.publish,this.subscribe=b.subscribe,this.listen=function(t,e){v.events.on(n,t,function(t){e.call(t.target,t,t.detail)})},this.x=function(t){return function(){var e=d.call(arguments);s(n.querySelectorAll(t),function(t){v.events.trigger(t,"execute",e)})}}}function c(t,n){return function(e,r){return v[t][e]=r,function(t,i){n.apply(this,[e,t]),r.apply(this,[t,i])}}}function a(){var t={},n={};return{subscribe:function(){var e=d.call(arguments),r=e[0],i=e[1],o=this;r in n&&t[r]?(t[r].push(i),o.publish.apply(null,[r].concat(n[r]))):(t[r]=t[r]||[],t[r].push(i))},publish:function(){var e=d.call(arguments),r=e.shift();t[r]=t[r]||[],t[r].length?s(t[r],function(t){t&&t.apply(this,e)}):n[r]=e}}}function s(t,n){for(var e=0,r=t.length;r>e;e++)n(t[e],e)}function l(t){var n=function(){};return n.prototype=t,new n}function f(t,n){for(var e=t.parentNode.querySelectorAll(n),r=e.length,i=0;r>i;i++)if(e[i]===t)return!0;return!1}function p(){function t(t,n){var e=document.createEvent(t);return n=n||{},e.initEvent(t,n.bubbles||!1,n.cancelable||!1,n.detail||null),e}var n=!0,e=function(){try{var t=new CustomEvent("c",{detail:{foo:"b"}});if("c"===t.type&&"b"===t.detail.foo)return CustomEvent}catch(n){return function(t,n){var e=document.createEvent("CustomEvent");return n=n||{},e.initCustomEvent(t,n.bubbles||!1,n.cancelable||!1,n.detail||null),e}}}();return{on:function(){return n?function(t,n,e){var r="focus"==n?"focusin":"blur"==n?"focusout":n;t.addEventListener(r,e,!1)}:function(t,n,e){t.addEventListener(n,e,"focus"==n||"blur"==n)}}(),off:function(t,n,e){t.removeEventListener(n,e,!1)},trigger:function(n,r,i){try{n.dispatchEvent(new t(r,{bubbles:!0,detail:i}))}catch(o){n.dispatchEvent(new e(r,{bubbles:!0,detail:i}))}}}}var v,d,h={},b=a(),m=document.documentElement;d=Array.prototype.slice,v={apps:{},controllers:{},components:{},events:p(),app:c("apps",u),controller:c("controllers",u),component:c("components",o),publish:b.publish,subscribe:b.subscribe,start:function(t){g.scan(t),m.className=m.className.replace("jls-ready","")+" jls-ready"},refresh:function(t){g.scan(t)},data:function(){return h},scanner:function(){return g},render:function(t,n){g.scan(t,function(t){v.events.trigger(t,"execute","destroy")}),t.innerHTML=n}};var g={scan:function(t,n){var e,r,i,o=this.entities;i=t||document;for(var u in o)e=o[u],r=i.querySelectorAll(e.selector),s(r,n||e.method)},entities:{components:{selector:"[data-component]",method:n},controllers:{selector:"[data-controller]",method:r("controller")},app:{selector:"[data-app]",method:r("app")}}};return v});
